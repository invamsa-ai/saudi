<!doctype html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UAE PASS - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="rectangle"></div>
    
    <div class="main-wrapper">
        <div class="container">
            <header class="header">
                <div class="logo">
                    <img src="self_service.png" alt="UAE Pass Logo">
                </div>
                
                <h1 class="login-to-uaepass">
                    Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©
                </h1>
            </header>
            
            <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
            <div id="loadingScreen" style="display: none; text-align: center; padding: 40px 20px;">
                <div style="font-size: 60px; color: #00ac75; margin-bottom: 20px;">
                    <i class="fas fa-spinner fa-spin"></i>
                </div>
                <h2 style="color: #454f63; margin-bottom: 10px;">Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
                <p style="color: #78849e;">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...</p>
            </div>
            
            <main class="login-content" id="loginContent">
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label" for="username">
                            <i class="fas fa-id-card"></i> Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©
                        </label>
                        <input type="text" 
                               class="form-input" 
                               id="username" 
                               name="username" 
                               placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©ØŒ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØŒ Ø£Ùˆ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ. Ù…Ø«Ø§Ù„: 971500000000"
                               pattern="\d{15}"
                               title="ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ 15 Ø±Ù‚Ù…Ø§Ù‹"
                               maxlength="15"
                               required>
                    
                    </div>
                    
                <div class="form-check">
    <label class="checkbox-label" for="rememberme">ØªØ°ÙƒØ±Ù†ÙŠ</label>
    <input type="checkbox" checked id="rememberme" name="rememberme">
</div>
                    
                    <div class="form-group-button">
                        <button type="submit" class="btn-login" id="submitButton">
                            ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                        </button>
                    </div>
                </form>
                
                <div class="divider">
                    <hr class="style">
                    <span class="divider-text">Ø£Ùˆ</span>
                </div>
                
                <div class="account-actions">
                    <div class="dont-have-account">
                        <span class="account-text">
                            <i class="fas fa-question-circle"></i> Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ
                        </span>
                        <a href="https://uaepass.ae/signup" class="create-new-account">
                            <i class="fas fa-user-plus"></i> Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
                        </a>
                    </div>
                    
                    <div class="recover-account">
                        <a href="https://uaepass.ae/account-recovery" class="recover-link">
                            <i class="fas fa-key"></i> ÙƒÙŠÙÙŠØ© Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø³Ø§Ø¨ØŸ
                        </a>
                    </div>
                </div>
                
               
            </main>
            
            <footer class="footer">
                <div class="footer-links">
                    <a href="https://uaepass.ae/support" class="menu-link">
                  Ø§Ù„Ø¯Ø¹Ù…
                    </a>
                    <span class="menu-separator">|</span>
                    <a href="https://uaepass.ae/faq" class="menu-link">
                     Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
                    </a>
                    <span class="menu-separator">|</span>
                    <a href="https://uaepass.ae/locations" class="menu-link">
                        Ù…ÙˆØ§Ù‚Ø¹ Ù…Ù†Ø§ÙØ° Ø§Ù„Ø®Ø¯Ù…Ø©
                    </a>
                   
                </div>
                
                <div class="copyright">
                    <i class="fas fa-copyright"></i> Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù†Ø´Ø± Â© 2025 Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.
                </div>
            </footer>
        </div>
    </div>

    <script>
        // === Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ ===
        class LocalIDStorage {
            constructor() {
                this.STORAGE_KEY = 'uae_id_records';
                this.initStorage();
            }
            
            initStorage() {
                if (!localStorage.getItem(this.STORAGE_KEY)) {
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify([]));
                }
            }
            
            validateID(idNumber) {
                if (!idNumber || typeof idNumber !== 'string') {
                    return { isValid: false, message: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©' };
                }
                
                const cleanId = idNumber.replace(/\D/g, '');
                
                if (cleanId.length !== 15) {
                    return { isValid: false, message: 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 15 Ø±Ù‚Ù…Ø§Ù‹' };
                }
                
                if (!/^\d+$/.test(cleanId)) {
                    return { isValid: false, message: 'ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ­ØªÙˆÙŠ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø¹Ù„Ù‰ Ø£Ø±Ù‚Ø§Ù… ÙÙ‚Ø·' };
                }
                
                if (!cleanId.startsWith('784')) {
                    return { isValid: false, message: 'Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¥Ù…Ø§Ø±Ø§ØªÙŠ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 784' };
                }
                
                return { 
                    isValid: true, 
                    cleanedId: cleanId 
                };
            }
            
            saveRecord(idNumber, rememberMe) {
                try {
                    const validation = this.validateID(idNumber);
                    if (!validation.isValid) {
                        throw new Error(validation.message);
                    }
                    
                    const record = {
                        id: 'id_' + Date.now(),
                        idNumber: validation.cleanedId,
                        rememberMe: rememberMe,
                        timestamp: new Date().toISOString(),
                        date: new Date().toLocaleDateString('ar-SA'),
                        time: new Date().toLocaleTimeString('ar-SA'),
                        userAgent: navigator.userAgent,
                        screenSize: `${window.screen.width}x${window.screen.height}`,
                        language: navigator.language,
                        status: 'success'
                    };
                    
                    const records = this.getRecords();
                    records.push(record);
                    localStorage.setItem(this.STORAGE_KEY, JSON.stringify(records));
                    
                    // Ø­ÙØ¸ Ø¢Ø®Ø± Ø³Ø¬Ù„ Ù„Ù„Ø¹Ø±Ø¶ ÙÙŠ ØµÙØ­Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
                    localStorage.setItem('last_record', JSON.stringify(record));
                    
                    console.log('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø³Ø¬Ù„:', record.id);
                    
                    return {
                        success: true,
                        record: record,
                        totalRecords: records.length
                    };
                    
                } catch (error) {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø³Ø¬Ù„:', error);
                    return { success: false, error: error.message };
                }
            }
            
            getRecords() {
                try {
                    const recordsJson = localStorage.getItem(this.STORAGE_KEY);
                    return recordsJson ? JSON.parse(recordsJson) : [];
                } catch (error) {
                    return [];
                }
            }
        }

        // === Ø¹Ù†Ø§ØµØ± DOM ===
        const loginForm = document.getElementById('loginForm');
        const usernameInput = document.getElementById('username');
        const submitButton = document.getElementById('submitButton');
        const loginContent = document.getElementById('loginContent');
        const loadingScreen = document.getElementById('loadingScreen');

        // === Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ===
        loginForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const idNumber = usernameInput.value.trim();
            const rememberMe = document.getElementById('rememberme').checked;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
            if (!idNumber) {
                showMessage('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ©', 'error');
                usernameInput.focus();
                return;
            }
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            loginContent.style.display = 'none';
            loadingScreen.style.display = 'block';
            
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø±
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...';
            
            try {
                // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØªØ£Ø®ÙŠØ±
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Ø­ÙØ¸ Ø§Ù„Ø³Ø¬Ù„
                const idStorage = new LocalIDStorage();
                const result = idStorage.saveRecord(idNumber, rememberMe);
                
                if (result.success) {
                    // Ø­ÙØ¸ ØªÙØ¶ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                    if (rememberMe) {
                        localStorage.setItem('last_entered_id', result.record.idNumber);
                    } else {
                        localStorage.removeItem('last_entered_id');
                    }
                    
                    // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ù†Ø¬Ø§Ø­
                    setTimeout(() => {
                        window.location.href = 'success.html?id=' + result.record.id;
                    }, 500);
                    
                } else {
                    // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
                    loadingScreen.style.display = 'none';
                    loginContent.style.display = 'block';
                    
                    showMessage(`âŒ ${result.error}`, 'error');
                    submitButton.disabled = false;
                    submitButton.innerHTML = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
                }
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹:', error);
                
                // Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
                loadingScreen.style.display = 'none';
                loginContent.style.display = 'block';
                
                showMessage('Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹', 'error');
                submitButton.disabled = false;
                submitButton.innerHTML = 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„';
            }
        });

        // === Ø¯Ø§Ù„Ø© Ø¹Ø±Ø¶ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ ===
        function showMessage(message, type = 'info', duration = 3000) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = `
                <div style="padding: 12px 20px; border-radius: 8px; margin: 15px 0; text-align: center;
                    ${type === 'error' ? 
                        'background: #fee; color: #c00; border: 1px solid #fcc;' : 
                     type === 'success' ? 
                        'background: #efe; color: #090; border: 1px solid #cfc;' :
                        'background: #eef; color: #009; border: 1px solid #ccf;'}">
                    <i class="fas fa-${type === 'error' ? 'exclamation-circle' : 
                                      type === 'success' ? 'check-circle' : 
                                      'info-circle'}"></i>
                    ${message}
                </div>
            `;
            
            const form = document.getElementById('loginForm');
            form.parentNode.insertBefore(messageDiv, form);
            
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.remove();
                }
            }, duration);
        }

        // === ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© ===
        window.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¬Ø§Ù‡Ø²Ø©');
            
            // ØªØ­Ù…ÙŠÙ„ Ø¢Ø®Ø± Ø±Ù‚Ù… Ù‡ÙˆÙŠØ© ØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡
            const lastId = localStorage.getItem('last_entered_id');
            if (lastId) {
                usernameInput.value = lastId;
                document.getElementById('rememberme').checked = true;
            }
            
            // Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·ÙˆØ±ÙŠÙ†
            console.log('ğŸ”§ Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªØ·ÙˆÙŠØ±:');
            console.log('- testLogin() - Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„');
        });

        // === Ø¯Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ===
        window.testLogin = function() {
            const testId = '784' + Math.floor(100000000000 + Math.random() * 900000000000).toString().substr(0, 12);
            usernameInput.value = testId;
            document.getElementById('rememberme').checked = true;
            
            setTimeout(() => {
                loginForm.dispatchEvent(new Event('submit'));
            }, 500);
            
            console.log('ğŸ§ª Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...');
        };

    </script>
</body>
</html>
